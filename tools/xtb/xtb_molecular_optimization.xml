<tool id="xtb_molecular_optimization" name="xtb molecular optimization" version="0.1.0+galaxy0" profile="21.05">
       <description>Semiempirical quantum mechanical molecular optimization method</description><creator>
        <person
            givenName="Wudmir"
            familyName="Rojas"
            url="https://github.com/wverastegui"
            identifier="0000-0001-7036-9987" />
        <person
            givenName="Helge"
            familyName="Hecht"
            url="https://github.com/hechth"
            identifier="0000-0001-6744-996X" />
        <organization
            url="https://www.recetox.muni.cz/"
            email="GalaxyToolsDevelopmentandDeployment@space.muni.cz"
            name="RECETOX MUNI"/>
    </creator>
    <requirements>
        <requirement type="package" version="6.6.1">xtb</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        ln '${coordinates}' 'mol.${coordinates.ext}' &&
        xtb 'mol.${coordinates.ext}' --opt '${opt_level}' && 
        cp 'xtbopt.${coordinates.ext}' '${output}'
    ]]></command>
    <inputs>
        <param label="Atomic coordinates file" type="data" name="coordinates" format="xyz, coord" help="Initial atomic coordinates file to be optimized."/>
        <param type="select" label="Optimization Levels" name="opt_level" help="Geometry optimization convergence levels." >
            <option value="crude">crude</option>
            <option value="tight">tight</option>
            <option value="extreme">extreme</option>
        </param>
    </inputs>
    <outputs>
        <data name="output" format_source="coordinates" />
    </outputs>
    <tests>
         <test>
            <param name="coordinates" value="initial_mol.xyz" ftype="xyz"/>
            <output name="output" file="optimized_mol.xyz" ftype="xyz">
                <assert_contents>
                    <has_n_lines n="26" delta="2"/>
                </assert_contents>
            </output>
        </test>
        <!-- <test>
            <param name="coordinates" value="initial_mol.coord" ftype="coord"/>
            <output name="output" file="optimized_mol.coord" ftype="coord">
                <assert_contents>
                    <has_text text="$coord"/>
                </assert_contents>
            </output>
        </test> -->
        <!-- <test>
            <param name="coordinates"/>
            <assert_stdout >
                <has_text text="optimized" />
            </assert_stdout>
        </test> -->
    </tests> 
    <help>
        <![CDATA[
        XTB Molecular Optimization handles coord and XYZ input formats, as well as, three levels of optimization.
        
        Documentation
            The xTB molecular optimization tool is based on the Semiempirical Tight Binding method GFNn-xTB implemented in the xtb (extended tight binding) 
            program package. Detailed documentation for the xtb program can be found in https://xtb-docs.readthedocs.io/en/latest/optimization.html.
        ]]>
    </help>
    <citations>
        <citation type="doi">https://doi.org/10.1002/wcms.1493</citation>
    </citations>
</tool>
